<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>T192 é€‰æ‹©æ’åºå¯è§†åŒ–</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f0f0f0;
    }
    .controls {
      margin-bottom: 20px;
    }
    #visual {
      display: flex;
      align-items: flex-end;
      height: 300px;
      margin-bottom: 20px;
      gap: 5px;
    }
    .bar {
      width: 30px;
      background-color: #4caf50;
      text-align: center;
      color: white;
      transition: height 0.3s ease, background-color 0.3s ease;
    }
    .bar.active {
      background-color: orange !important;
    }
    .bar.min {
      background-color: red !important;
    }
    .bar.sorted {
      background-color: gray !important;
    }
    #log {
      background-color: #111;
      color: #0f0;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      font-family: monospace;
      white-space: pre-wrap;
    }
    input[type="text"], input[type="number"] {
      padding: 5px;
      width: 300px;
      margin-bottom: 10px;
    }
    button {
      padding: 8px 16px;
      font-size: 16px;
    }
    a {
      display: inline-block;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h2>ğŸ” T192 é€‰æ‹©æ’åºå¯è§†åŒ–</h2>

  <div class="controls">
    è¾“å…¥æ•°ç»„ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼š<br>
    <input type="text" id="inputArray" value="5,1,4,2,8"><br>
    åŠ¨ç”»é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼š<input type="number" id="interval" value="1000" min="100" max="5000"><br>
    <button onclick="startSort()">å¯è§†åŒ–æ’åº</button>
  </div>

  <div id="visual"></div>

  <div id="log"></div>

  <a href="index.html">â† è¿”å›é¦–é¡µ</a>

  <script>
    function log(msg) {
      const logBox = document.getElementById('log');
      logBox.innerText += msg + "\n";
      logBox.scrollTop = logBox.scrollHeight;
    }

    function render(array, highlight = [], minIdx = -1, sorted = []) {
      const container = document.getElementById('visual');
      container.innerHTML = '';
      const maxVal = Math.max(...array);
      array.forEach((val, idx) => {
        const bar = document.createElement('div');
        bar.classList.add('bar');
        if (highlight.includes(idx)) bar.classList.add('active');
        if (minIdx === idx) bar.classList.add('min');
        if (sorted.includes(idx)) bar.classList.add('sorted');
        bar.style.height = `${(val / maxVal) * 100 + 50}px`;
        bar.innerText = val;
        container.appendChild(bar);
      });
    }

    async function selectionSortVisual(arr, delay) {
      const len = arr.length;
      let sorted = [];

      for (let i = 0; i < len; i++) {
        let minIdx = i;
        log(`ç¬¬ ${i + 1} è½®å¼€å§‹ï¼Œåˆå§‹ minIdx = ${minIdx} (å€¼=${arr[minIdx]})`);
        render(arr, [i], minIdx, sorted);
        await new Promise(r => setTimeout(r, delay));

        for (let j = i + 1; j < len; j++) {
          render(arr, [j], minIdx, sorted);
          log(`æ¯”è¾ƒ nums[${j}] = ${arr[j]} å’Œå½“å‰æœ€å° nums[${minIdx}] = ${arr[minIdx]}`);
          await new Promise(r => setTimeout(r, delay));

          if (arr[j] < arr[minIdx]) {
            minIdx = j;
            log(`æ›´æ–° minIdx = ${minIdx} (å€¼=${arr[minIdx]})`);
            render(arr, [j], minIdx, sorted);
            await new Promise(r => setTimeout(r, delay));
          }
        }

        if (minIdx !== i) {
          log(`äº¤æ¢ nums[${i}] = ${arr[i]} å’Œ nums[${minIdx}] = ${arr[minIdx]}`);
          [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
          render(arr, [], i, sorted);
          await new Promise(r => setTimeout(r, delay));
        } else {
          log(`å½“å‰ä½ç½® ${i} å·²æ˜¯æœ€å°å€¼ï¼Œæ— éœ€äº¤æ¢`);
        }

        sorted.push(i);
        log(`ç¬¬ ${i + 1} è½®ç»“æŸï¼Œå½“å‰æ•°ç»„ï¼š${arr.join(', ')}`);
      }

      render(arr, [], -1, Array.from({length: arr.length}, (_, i) => i));
      log(`âœ… æ’åºå®Œæˆï¼š${arr.join(', ')}`);
    }

    function startSort() {
      const input = document.getElementById('inputArray').value;
      const interval = parseInt(document.getElementById('interval').value) || 1000;
      const arr = input.split(',').map(x => parseInt(x.trim())).filter(x => !isNaN(x));
      if (arr.length === 0) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°ç»„");
        return;
      }

      document.getElementById('log').innerText = '';
      log(`å¼€å§‹æ’åºï¼š${arr.join(', ')}`);
      render(arr);
      selectionSortVisual(arr, interval);
    }
  </script>
</body>
</html>
